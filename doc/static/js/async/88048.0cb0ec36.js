"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["88048"],{45261:function(e,s,n){n.r(s);var i=n(85893),r=n(50065),l=n(95895);function o(e){let s=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",div:"div",pre:"pre",code:"code",span:"span"},(0,r.ah)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.h1,{id:"model-checking",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#model-checking",children:"#"}),"Model Checking"]}),"\n",(0,i.jsx)(l.Z,{}),"\n",(0,i.jsx)(s.p,{children:"In engineering practice, since not all floating-point models can be converted to quantized models, checking is required before conversion.\nThis checking process will go through the process of a model conversion."}),"\n",(0,i.jsx)(s.p,{children:"However, for those more time-consuming procedures, we simplified the checking process.\nThis command will output the check results and the OP deployment on the device when it finishes the checking of the model."}),"\n",(0,i.jsxs)(s.h2,{id:"usage",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#usage",children:"#"}),"Usage"]}),"\n",(0,i.jsxs)(s.div,{className:"rspress-directive warning",children:[(0,i.jsx)(s.div,{className:"rspress-directive-title",children:"Attention"}),(0,i.jsx)(s.div,{className:"rspress-directive-content",children:(0,i.jsxs)(s.p,{children:["Please use the ",(0,i.jsx)(s.a,{href:"/3.0.22/en/guide/ptq/ptq_tool/hbruntime.html",children:"HBRuntime"})," to inference your floating-point onnx model to make sure the model is legal, and then refer to the method below to use hb_compile to check if the model can be converted to a quantized model."]})})]}),"\n",(0,i.jsx)(s.p,{children:"How To Use:"}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"hb_compile"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--march"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ${march} \\"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--proto"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ${caffe_proto} \\"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ${caffe_model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"onnx_model} \\"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--input-shape"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ${input_node_name} ${input_shape} "})]}),"\n"]})})}),"\n",(0,i.jsx)(s.p,{children:"If your model is a multi-input model, you can refer to the following command:"}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"hb_compile"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--march"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ${march} \\"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--proto"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ${caffe_proto} \\"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ${caffe_model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"onnx_model} \\"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--input-shape"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"input.0"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"x1x224x224"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"--input-shape"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"input.1"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"x1x224x224"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"--input-shape"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"input.2"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"x1x224x224"})]}),"\n"]})})}),"\n",(0,i.jsxs)(s.h2,{id:"parameters-introduction",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#parameters-introduction",children:"#"}),"Parameters Introduction"]}),"\n",(0,i.jsxs)("table",{children:[(0,i.jsxs)("colgroup",{children:[(0,i.jsx)("col",{style:{width:"20%"}}),(0,i.jsx)("col",{style:{width:"80%"}})]}),(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"Parameter Name"})}),(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"Parameter Description"})})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("code",{children:"-h, --help"})}),(0,i.jsx)("td",{children:"Show help information and exit."})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("code",{children:"--march"})}),(0,i.jsxs)("td",{children:["BPU's micro architectures, for J6E processor, you should specify it to ",(0,i.jsx)("code",{children:"nash-e"}),",\nfor J6M processor, you should specify it to ",(0,i.jsx)("code",{children:"nash-m"}),"."]})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("code",{children:"-m, --model"})}),(0,i.jsxs)("td",{children:["Floating-point model file of Caffe/ONNX.\n",(0,i.jsxs)("ul",{className:"list-disc pl-5 my-4 leading-7",children:[(0,i.jsx)("li",{children:"Caffe model: the value is the name of the caffemodel file for the Caffe model."}),"\n",(0,i.jsx)("li",{children:"ONNX model: the value is the name of the ONNX model file."})]})]})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("code",{children:"--proto"})}),(0,i.jsx)("td",{children:"Specify the Prototxt file of the Caffe model."})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("code",{children:"-i, --input-shape"})}),(0,i.jsxs)("td",{children:["Input node and input shape of the node, optional, where the shape should be separated by",(0,i.jsx)("code",{children:"x"}),". ",(0,i.jsx)("br",{}),"\nThe value is ",(0,i.jsx)("code",{children:"{input_name} {NxHxWxC/NxCxHxW}"}),", and the ",(0,i.jsx)("code",{children:"input_name"}),"is separated from the shape by space.\nFor example, if the model input node name is",(0,i.jsx)("code",{children:"data"}),", and the input shape is",(0,i.jsx)("code",{children:"[1,3,224,224]"}),", the value should be ",(0,i.jsx)("code",{children:"data 1x3x224x224"}),".\nIf the shape configured here is not the same as the shape information in the model, the configuration here will take precedence.",(0,i.jsx)("br",{}),"\n",(0,i.jsxs)("b",{children:["Note that an ",(0,i.jsx)("code",{children:"--input-shape"}),"only accepts one name and shape combination, if your model has multiple input nodes, just configure the ",(0,i.jsx)("code",{children:"--input-shape"}),"parameter multiple times in the command."]})]})]})]})]}),"\n",(0,i.jsxs)(s.div,{className:"rspress-directive info",children:[(0,i.jsx)(s.div,{className:"rspress-directive-title",children:"Note"}),(0,i.jsx)(s.div,{className:"rspress-directive-content",children:(0,i.jsxs)(s.p,{children:["If you find that the ",(0,i.jsx)(s.code,{children:"The converted model node information"})," results during model checking does not match the ",(0,i.jsx)(s.code,{children:"The converted model node information"})," results during model quantized compilation,\nit may be because there is actually a default yaml configuration during the model checking process, and if you configured the yaml before the conversion,\nsome parameter differences may cause this if you configure yaml before model quantized compilation, some parameters may cause this situation.\nThe yaml configuration parameters that may cause this to happen include: ",(0,i.jsx)(s.code,{children:"mean_value"})," , ",(0,i.jsx)(s.code,{children:"scale_value"})," ",(0,i.jsx)(s.code,{children:"std_value"})," and ",(0,i.jsx)(s.code,{children:"quant_config"}),"."]})})]})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,r.ah)(),e.components);return s?(0,i.jsx)(s,Object.assign({},e,{children:(0,i.jsx)(o,e)})):o(e)}s.default=t,t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["3.0.22%2Fen%2Fguide%2Fptq%2Fptq_tool%2Fhb_compile%2Fcheck.mdx"]={toc:[{id:"usage",text:"Usage",depth:2},{id:"parameters-introduction",text:"Parameters Introduction",depth:2}],title:"Model Checking",frontmatter:{}}},95895:function(e,s,n){n(39710);var i=n(85893),r=n(67294),l=n(45687);n(20388);let o={"zh-CN":e=>`\u{9884}\u{8BA1}\u{9605}\u{8BFB}\u{65F6}\u{95F4}: ${e.minutes>=1?`${Math.ceil(e.minutes)} \u{5206}\u{949F}`:"\u5C0F\u4E8E 1 \u5206\u949F"}`,"en-US":e=>`Estimated reading time: ${e.minutes>=1?`${Math.ceil(e.minutes)} minutes`:"less than 1 minute"}`};function t(e,s,n){let i=Object.keys(o).includes(s)?s:n;return o[i](e)}s.Z=e=>{let{defaultLocale:s="en-US"}=e,n=(0,l.Vi)().page.readingTimeData,o=(0,l.Jr)(),c=(0,l.e7)(),[a,h]=(0,r.useState)(t(n,o,s));return(0,r.useEffect)(()=>{h(t(n,o,s))},[o,n]),(0,i.jsx)("span",{"data-dark":String(c),className:"rp-reading-time",children:a})}}}]);