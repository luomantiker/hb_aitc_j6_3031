"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["97073"],{65442:function(e,s,n){e.exports=n.p+"static/image/bpu_trace_overview.30e7a09e.png"},83950:function(e,s,n){e.exports=n.p+"static/image/bpu_trace_schedule.c7e5e824.png"},59398:function(e,s,n){e.exports=n.p+"static/image/ucp_bpu_trace.4a3959d2.png"},79889:function(e,s,n){e.exports=n.p+"static/image/chrome_task.3f51867a.png"},49814:function(e,s,n){e.exports=n.p+"static/image/chrome_thread.b63d354a.png"},34263:function(e,s,n){e.exports=n.p+"static/image/ucp_in_process.7302e351.png"},35166:function(e,s,n){e.exports=n.p+"static/image/ucp_system.b0b4462d.png"},45468:function(e,s,n){e.exports=n.p+"static/image/ucp_trace_flow.aadd6581.png"},89939:function(e,s,n){n.r(s);var r=n(85893),i=n(50065),l=n(95895),t=n(34263),c=n(45468),o=n(35166),a=n(65442),h=n(83950),d=n(59398),x=n(79889),p=n(49814);function j(e){let s=Object.assign({h1:"h1",a:"a",p:"p",code:"code",ul:"ul",li:"li",pre:"pre",span:"span",h2:"h2",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",div:"div",h3:"h3",h4:"h4",h5:"h5",ol:"ol"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"ucp-trace-instructions",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#ucp-trace-instructions",children:"#"}),"UCP Trace Instructions"]}),"\n",(0,r.jsx)(l.Z,{}),"\n",(0,r.jsx)(s.p,{children:"UCP Trace provides the ability to in-depth analysis of the scheduling logic of UCP applications by embedding trace recording on the critical path executed by UCP. when performance anomalies occur, it can quickly locate the time point of the anomaly by analyzing UCP trace."}),"\n",(0,r.jsxs)(s.p,{children:["UCP trace provides two trace backend options: ",(0,r.jsx)(s.code,{children:"Perfetto Trace"})," and ",(0,r.jsx)(s.code,{children:"Chrome Trace"}),". You can choose between them by setting an environment variable to meet your sepecific performance tracking needs."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Perfetto trace can retrieve ucp recorded traces, as well as system status, ftrace information, etc."}),"\n",(0,r.jsx)(s.li,{children:"Chrome trace can only retrieve ucp recoreded traces and is mainly used to analyze UCP's scheduling logic."}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["The UCP trace tool and configuration files are located in the ",(0,r.jsx)(s.code,{children:"samples/ucp_tutorial/tools"})," directory path, with a directory structures as follows:"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"tools/"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"\u2514\u2500\u2500"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"trace"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                          "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# trace tools"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"\u251C\u2500\u2500"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"catch_trace.sh"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"               "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# catch script for chrome trace"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"\u251C\u2500\u2500"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"configs"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                      "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Reference configuration files"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"\u2502"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"\u251C\u2500\u2500"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_bpu_trace.cfg"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# perfetto configuration file for bpu trace"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"\u2502"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"\u251C\u2500\u2500"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_in_process.cfg"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# perfetto configuration file for in_process mode"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"\u2502"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"\u251C\u2500\u2500"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_in_process.json"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# ucp configuration file for in_process mode"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"\u2502"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"\u251C\u2500\u2500"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_system.cfg"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# perfetto configuration file for system mode"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"\u2502"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"\u2514\u2500\u2500"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_system.json"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"          "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# ucp configuration file for system mode"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.h2,{id:"environmental-variable",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#environmental-variable",children:"#"}),"Environmental Variable"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Environmental Variable"}),(0,r.jsx)(s.th,{children:"Range of values"}),(0,r.jsx)(s.th,{children:"Default values"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"HB_UCP_ENABLE_PERFETTO"})}),(0,r.jsx)(s.td,{children:"true\uFF0Cfalse"}),(0,r.jsx)(s.td,{children:"false"}),(0,r.jsx)(s.td,{children:"Whether to enable the perfetto trace, defaults to not starting."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"HB_UCP_PERFETTO_CONFIG_PATH"})}),(0,r.jsx)(s.td,{children:"Perfetto configuration file path"}),(0,r.jsx)(s.td,{children:'""'}),(0,r.jsx)(s.td,{children:"Specify the path to the perfetto configuration file. By default, it is empty, and if you do not need UCP to initialize perfetto, you can ignore this enviromental variable."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"HB_UCP_TRACE_LOG_LEVEL"})}),(0,r.jsx)(s.td,{children:"[0, 6]"}),(0,r.jsx)(s.td,{children:"6"}),(0,r.jsx)(s.td,{children:"Specify the UCP trace log level, which defaults to 6 and is not output."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"HB_UCP_USE_ALOG"})}),(0,r.jsx)(s.td,{children:"true\uFF0Cfalse"}),(0,r.jsx)(s.td,{children:"false"}),(0,r.jsx)(s.td,{children:"Whether to enable the alog sink\uFF0Cdefaults disabled. If enabled, logs will be output to the alog buffer and can be captured using logcat while logging is disabled for terminal output."})]})]})]}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive info",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"Note"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.p,{children:["Perfetto Trace has a higher priority and if ",(0,r.jsx)(s.code,{children:"export HB_UCP_ENABLE_PERFETTO=true"})," while ",(0,r.jsx)(s.code,{children:"export UCP_TRACE_LOG_LEVEL=0"})," is also set,\nthen only perfetto trace will be started and the ucp trace log will be ignored."]})})]}),"\n",(0,r.jsxs)(s.h2,{id:"ucp-trace-records",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#ucp-trace-records",children:"#"}),"UCP Trace Records"]}),"\n",(0,r.jsx)(s.p,{children:"UCP add trace records in the application API and internal critical scheduling paths, including task trace records and operator records."}),"\n",(0,r.jsxs)(s.h3,{id:"task-trace-records",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#task-trace-records",children:"#"}),"Task Trace Records"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"hbDNNInfer"})}),(0,r.jsx)(s.td,{children:"Create a model inference task"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"hbVPxxx"})}),(0,r.jsx)(s.td,{children:"Create a vision process task"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"hbHPLxxx"})}),(0,r.jsx)(s.td,{children:"Create a high performance compute task"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"hbUCPSubmitTask"})}),(0,r.jsx)(s.td,{children:"Submit Task"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"${TaskType}::Wait"})}),(0,r.jsx)(s.td,{children:"Wait task done"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"TaskSetDone"})}),(0,r.jsx)(s.td,{children:"Notify task done"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"hbUCPReleaseTask"})}),(0,r.jsx)(s.td,{children:"Release task"})]})]})]}),"\n",(0,r.jsxs)(s.h3,{id:"operator-trace-records",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#operator-trace-records",children:"#"}),"Operator Trace Records"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Name"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"SubmitOp"})}),(0,r.jsx)(s.td,{children:"Submit operator"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"OpInfer"})}),(0,r.jsx)(s.td,{children:"Operator inference"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"OpFnish"})}),(0,r.jsx)(s.td,{children:"Operator finish"})]})]})]}),"\n",(0,r.jsxs)(s.h2,{id:"perfetto-trace",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#perfetto-trace",children:"#"}),"Perfetto Trace"]}),"\n",(0,r.jsxs)(s.h3,{id:"overview",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#overview",children:"#"}),"Overview"]}),"\n",(0,r.jsxs)(s.p,{children:["Perfetto is a system analysis tool developed and open-sourced by Google, which can collect performance data from different data sources and provides the ",(0,r.jsx)(s.code,{children:"Perfetto UI"})," for data visualization and analysis.\nFor more details on Perfetto, please refer to the ",(0,r.jsx)("a",{href:"https://perfetto.dev/docs/",children:"Perfetto offical document"}),"."]}),"\n",(0,r.jsxs)(s.h3,{id:"configuration-file",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#configuration-file",children:"#"}),"Configuration File"]}),"\n",(0,r.jsxs)(s.h4,{id:"ucp-trace-configuration-file",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#ucp-trace-configuration-file",children:"#"}),"UCP Trace Configuration File"]}),"\n",(0,r.jsxs)(s.p,{children:["You can configure UCP to use the ",(0,r.jsx)(s.code,{children:"Perfetto"})," by specifying it through the environment variable ",(0,r.jsx)(s.code,{children:"HB_UCP_PERFETTO_CONFIG_PATH"}),"."]}),"\n",(0,r.jsxs)(s.h4,{id:"parameters-description",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#parameters-description",children:"#"}),"Parameters Description"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Parameter"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Range of values"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"backend"})}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:'"in_process"\uFF0C"system"'}),(0,r.jsxs)(s.td,{children:["in_process represents the process-internal mode, where the perfetto trace is directly saved to a file within the process. System represents the system mode, where trace capture is performed by the background service ",(0,r.jsx)(s.code,{children:"traced"})," and ",(0,r.jsx)(s.code,{children:"traced_probe"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"trace_config"})}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"configuration file for perfetto"}),(0,r.jsx)(s.td,{children:"It is available when the backend is set to in_process, the file is protobuf text format."})]})]})]}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive info",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"Note"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.p,{children:["The UCP trace configuration file is not necessary when your application has already initiaized ",(0,r.jsx)(s.code,{children:"Perfetto"}),", you only need to ",(0,r.jsx)(s.code,{children:"export HB_UCP_ENABLE_PERFETTO=true"})," to enable Perfetto."]})})]}),"\n",(0,r.jsxs)(s.h4,{id:"example-1in_process-mode",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#example-1in_process-mode",children:"#"}),"Example 1\uFF1Ain_process mode"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:'"backend"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"in_process"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:'"trace_config"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ucp_in_process.cfg"'})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n"]})})}),"\n",(0,r.jsxs)(s.h4,{id:"example-2system-mode",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#example-2system-mode",children:"#"}),"Example 2\uFF1Asystem mode"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:'"backend"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"system"'})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n"]})})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive info",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"Note"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.p,{children:["When selecting the ",(0,r.jsx)(s.code,{children:"system"})," for ",(0,r.jsx)(s.code,{children:"backend"}),", there is no need to specify ",(0,r.jsx)(s.code,{children:"trace_config"})," separately for UCP."]})})]}),"\n",(0,r.jsxs)(s.h4,{id:"perfetto-configuration-file",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#perfetto-configuration-file",children:"#"}),"Perfetto Configuration File"]}),"\n",(0,r.jsxs)(s.p,{children:["For detailed information about perfetto configuration files, please refer to ",(0,r.jsx)("a",{href:"https://perfetto.dev/docs/reference/trace-config-proto",children:"Perfetto TraceConfig Reference"}),".\nUCP provides reference configuration files ",(0,r.jsx)(s.code,{children:"ucp_in_process.cfg"})," and ",(0,r.jsx)(s.code,{children:"ucp_system.cfg"}),", which can be modified based on application scenario."]}),"\n",(0,r.jsxs)(s.h4,{id:"exampleucp_in_processcfg",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#exampleucp_in_processcfg",children:"#"}),"Example\uFF1Aucp_in_process.cfg"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Enable periodic flushing of the trace buffer into the output file."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"write_into_file:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"true"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Output file path"})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"output_path:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ucp.pftrace"'})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Sampling duration: 10s"})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"duration_ms:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10000"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Writes the userspace buffer into the file every 2.5 seconds."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"file_write_period_ms:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2500"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"buffers"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"{"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# buffer size"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"size_kb:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"65535"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# DISCARD: no new sampling data will be stored when the storage is full."})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# RING_BUFFER: old sampling data will be discarded and new data will be stored when the storage is full."})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"fill_policy:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"RING_BUFFER"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# UCP data source"})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"data_sources:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"{"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"config"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"{"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"name:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"track_event"'})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"track_event_config"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"{"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"enabled_categories:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"dnn"'})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n"]})})}),"\n",(0,r.jsxs)(s.h3,{id:"example",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#example",children:"#"}),"Example"]}),"\n",(0,r.jsxs)(s.h4,{id:"in_process-mode",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#in_process-mode",children:"#"}),"in_process mode"]}),"\n",(0,r.jsx)(s.p,{children:"In the in_process mode, only trace within UCP process can be captured, and it is not necessary to start the background process of perfetto."}),"\n",(0,r.jsxs)(s.h5,{id:"operating-procedure",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#operating-procedure",children:"#"}),"Operating Procedure"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Configure environment variables."}),"\n"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Specify the ucp perfetto configuration path."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" HB_UCP_PERFETTO_CONFIG_PATH"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_in_process.json"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Enable perfetto."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" HB_UCP_ENABLE_PERFETTO"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"true"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive info",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"Note"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.p,{children:["In the ",(0,r.jsx)(s.code,{children:"ucp_in_process.json"}),", the configuration file for perfetto is specified as ",(0,r.jsx)(s.code,{children:"ucp_in_process.cfg"}),", and the ",(0,r.jsx)(s.code,{children:"output_path"})," specifies the path for output trace file.\nDue to the fact that Perfetto does not support directly overwriting existing trace files, if the file already exists, it needs to be deleted first."]})})]}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsxs)(s.li,{children:["Running the UCP application, using ",(0,r.jsx)(s.code,{children:"hrt_model_exec"})," as an example."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Due to the specified file path is a relative path, the trace configuration file and scripts need to be placed in the same level directory as the running program. Also, you need to make sure that you configure the environment variables and run the program in the same shell environment."}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"./hrt_model_exec"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"perf"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                      \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--model_file"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"resnet50_224x224_nv12.hbm"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--frame_count"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1000"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                     \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--thread_num"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"8"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.ol,{start:"3",children:["\n",(0,r.jsxs)(s.li,{children:["The generated trace is saved in the output file ",(0,r.jsx)(s.code,{children:"ucp.pftrace"})," specified by the ",(0,r.jsx)(s.code,{children:"perfetto"})," command, and you can use ",(0,r.jsx)("a",{href:"https://ui.perfetto.dev/",children:"Perfetto UI"})," to open it."]}),"\n"]}),"\n",(0,r.jsx)("img",{src:t,alt:"ucp_in_process",height:"700",width:"700"}),"\n",(0,r.jsxs)(s.ol,{start:"4",children:["\n",(0,r.jsx)(s.li,{children:"Clicking on the task in the timeline will show the complete scheduling process from creation to release of the task."}),"\n"]}),"\n",(0,r.jsx)("img",{src:c,alt:"ucp_trace_flow",height:"700",width:"700"}),"\n",(0,r.jsxs)(s.ol,{start:"5",children:["\n",(0,r.jsxs)(s.li,{children:["The common operations of ",(0,r.jsx)(s.code,{children:"Perfetto UI"})," are as follows, for more detailed operation Instructions, please refer to the ",(0,r.jsx)(s.code,{children:"help"})," interface."]}),"\n"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Operations"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"w"})," or ctrl + scroll up with the mouse wheeel"]}),(0,r.jsx)(s.td,{children:"Zoom in"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"s"})," or ctrl + scroll down with the mouse wheeel"]}),(0,r.jsx)(s.td,{children:"zoom out"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"a"})," or drag the time bar to the left"]}),(0,r.jsx)(s.td,{children:"Pan left"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"d"})," or drag the time bar to the right"]}),(0,r.jsx)(s.td,{children:"Pan right"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"?"})}),(0,r.jsx)(s.td,{children:"Show help"})]})]})]}),"\n",(0,r.jsxs)(s.h4,{id:"system-mode",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#system-mode",children:"#"}),"system mode"]}),"\n",(0,r.jsxs)(s.p,{children:["In system mode, UCP trace is just one of the data sources, so it it necessary to run the corresponding commands for ",(0,r.jsx)(s.code,{children:"tracebox"})," to complete the capture of trace."]}),"\n",(0,r.jsxs)(s.h5,{id:"operating-procedure-1",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#operating-procedure-1",children:"#"}),"Operating Procedure"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Running the perfetto background process."}),"\n"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Start trace service."})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Start once, no need to start it again when it is already started."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"tracebox"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"traced"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--background"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Start data capture service."})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Start once, no need to start it again when it is already started."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"tracebox"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"traced_probes"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--background"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--reset-ftrace"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsx)(s.li,{children:"Trigger data capture."}),"\n"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# -c: Specify perfetto configuration file"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# -o: Specify output path of trace data."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"tracebox"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"perfetto"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--txt"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-c"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_system.cfg"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-o"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp.pftrace"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.ol,{start:"3",children:["\n",(0,r.jsx)(s.li,{children:"Open a new terminal and configure the UCP environment variables."}),"\n"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Specify the ucp perfetto configuration path."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" HB_UCP_PERFETTO_CONFIG_PATH"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_system.json"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Enable perfetto."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" HB_UCP_ENABLE_PERFETTO"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"true"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.ol,{start:"4",children:["\n",(0,r.jsxs)(s.li,{children:["Running the UCP application, using ",(0,r.jsx)(s.code,{children:"hrt_model_exec"})," as an example."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["To be able to capture complete data, it is necessary to ensure that the perfetto process does not exit before the ",(0,r.jsx)(s.code,{children:"hrt_model_exec"})," execution is complete."]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"./hrt_model_exec"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"perf"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                      \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--model_file"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"resnet50_224x224_nv12.hbm"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--frame_count"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1000"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                     \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--thread_num"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"8"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.ol,{start:"5",children:["\n",(0,r.jsxs)(s.li,{children:["The generated trace is saved in ",(0,r.jsx)(s.code,{children:"ucp.pftrace"}),", and you can use ",(0,r.jsx)("a",{href:"https://ui.perfetto.dev/",children:"Perfetto UI"})," to open it."]}),"\n"]}),"\n",(0,r.jsx)("img",{src:o,alt:"ucp_system",height:"700",width:"700"}),"\n",(0,r.jsxs)(s.h3,{id:"bpu-trace",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#bpu-trace",children:"#"}),"BPU Trace"]}),"\n",(0,r.jsxs)(s.p,{children:["In system mode, BPU trace capture is supported. Simply add BPU trace data source to the perfetto configuration file. The ",(0,r.jsx)(s.code,{children:"ucp_bpu_trace.cfg"})," file has already defaultly included the BPU trace data source.\nThe specific configuration items are shown below."]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"data_sources:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"{"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"config"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"{"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"name:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"linux.sys_stats"'})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"sys_stats_config"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"{"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"bputrace_period_ms:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"500"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n"]})})}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.code,{children:"bpu_trace_period_ms"})," is used to set the period for reading the BPU trace. You can adjust this parameter according to your actual usage scenario. When the BPU load is high,\nyou can appropriately shorted the reading period to avoid the problem of trace data being overwritten due to mismatched read and write speeds."]}),"\n",(0,r.jsx)(s.p,{children:"To demonstrate the BPU trace during the inference process of multiple models, an example of a multi-process application is provided here. Except for the different running programs being launched,\nthe rest of the steps are the same as in the previous chapter."}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"./hrt_model_exec"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"perf"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                        \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--model_file"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"resnet50_224x224_nv12.hbm"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--frame_count"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"50"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                         \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--thread_num"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"&"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                         \\"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"./hrt_model_exec"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"perf"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                        \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--model_file"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"googlenet_224x224_nv12.hbm"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--frame_count"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"50"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                         \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--thread_num"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                           \\"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.p,{children:["Visualization of BPU trace requires the use of the ",(0,r.jsx)(s.code,{children:"hbperfetto"})," tool, which is custom-developed by Horizon Robotics. You can obtain this tool by contacting the Horizon Robotics technical support personnel.\nThe effect of opening a trace file using ",(0,r.jsx)(s.code,{children:"hbperfetto"})," is shown in the image below."]}),"\n",(0,r.jsx)("img",{src:a,alt:"bpu_trace_overview",height:"700",width:"700"}),"\n",(0,r.jsx)(s.p,{children:"The scheduling of different model inference tasks presented in BPU trace is shown in the following figure."}),"\n",(0,r.jsx)("img",{src:h,alt:"bpu_trace_schedule",height:"700",width:"700"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"hbperfetto"})," supports the association of UCP trace and BPU trace. The following diagram illustrates the complete process from the creating, submission,\nscheduling and execution, to the task's completion and eventual releases."]}),"\n",(0,r.jsx)("img",{src:d,alt:"ucp_bpu_trace",height:"700",width:"700"}),"\n",(0,r.jsxs)(s.h2,{id:"chrome-trace",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#chrome-trace",children:"#"}),"Chrome Trace"]}),"\n",(0,r.jsx)(s.p,{children:"Chrome trace only supports capturing UCP trace, and does not support capturing data sources. For capturing multiple data sources,\nplease use Perfetto trace. The characteristic of Chrome trace is simplicity and ease of use, using text logs to record traces without depending on any extra thrid-party libraries or tools. If you are only interested in the scheduling logic of UCP,\nyou can use Chrome trace to capture it."}),"\n",(0,r.jsxs)(s.h3,{id:"example-1",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#example-1",children:"#"}),"Example"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Configure environment variables."}),"\n"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Disable perfetto"})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" HB_UCP_ENABLE_PERFETTO"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"false"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Set the log level of UCP trace to 0."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" HB_UCP_TRACE_LOG_LEVEL"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Set the file path for UCP log saving."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" HB_UCP_LOG_PATH"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_log.txt"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive info",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"Note"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsx)(s.p,{children:"Before starting new capture, it is recommended to delete the old log files to avoid interference from old data."})})]}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsxs)(s.li,{children:["Running the UCP application, using ",(0,r.jsx)(s.code,{children:"hrt_model_exec"})," as an example."]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"./hrt_model_exec"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"perf"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                      \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--model_file"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"resnet50_224x224_nv12.hbm"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--thread_num"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"8"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.ol,{start:"3",children:["\n",(0,r.jsx)(s.li,{children:"Execute trace capture script."}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["After capturing the trace logs, run the ",(0,r.jsx)(s.code,{children:"catch_trace.sh"})," provided in the UCP distribution package to convert the raw trace logs into a json-formatted trace file."]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# -i: Specify input trace log file"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# -o: Specify output json-formatted trace file."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"./catch_trace.sh"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-i"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_log.txt"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-o"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_trace_task.json"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Visualize trace as task view by defalut, but you can switch to thread view as well."})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# -m: Specify convert mode\uFF0Ctask: task view (default)\uFF0Cthread: thread view."})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"./catch_trace.sh"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-m"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"thread"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-i"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_log.txt"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-o"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ucp_trace_thread.json"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.ol,{start:"4",children:["\n",(0,r.jsxs)(s.li,{children:["Open ",(0,r.jsx)(s.code,{children:"ucp_trace_task.json"})," and ",(0,r.jsx)(s.code,{children:"ucp_trace_thread.json"})," using ",(0,r.jsx)("a",{href:"https://ui.perfetto.dev/",children:"Perfetto UI"})," or Chrome UI(",(0,r.jsx)(s.code,{children:"chrome://tracing/"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Open ",(0,r.jsx)(s.code,{children:"ucp_trace_task.json"})," by Chrome UI:"]}),"\n",(0,r.jsx)("img",{src:x,alt:"chrome_task",height:"700",width:"700"}),"\n",(0,r.jsxs)(s.p,{children:["Open ",(0,r.jsx)(s.code,{children:"ucp_trace_thread.json"})," by Perfetto UI:"]}),"\n",(0,r.jsx)("img",{src:p,alt:"chrome_thread",height:"700",width:"700"})]})}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.ah)(),e.components);return s?(0,r.jsx)(s,Object.assign({},e,{children:(0,r.jsx)(j,e)})):j(e)}s.default=m,m.__RSPRESS_PAGE_META={},m.__RSPRESS_PAGE_META["3.0.22%2Fen%2Fguide%2Fucp%2Fucp_tools%2Fucp_trace.mdx"]={toc:[{id:"environmental-variable",text:"Environmental Variable",depth:2},{id:"ucp-trace-records",text:"UCP Trace Records",depth:2},{id:"task-trace-records",text:"Task Trace Records",depth:3},{id:"operator-trace-records",text:"Operator Trace Records",depth:3},{id:"perfetto-trace",text:"Perfetto Trace",depth:2},{id:"overview",text:"Overview",depth:3},{id:"configuration-file",text:"Configuration File",depth:3},{id:"ucp-trace-configuration-file",text:"UCP Trace Configuration File",depth:4},{id:"parameters-description",text:"Parameters Description",depth:4},{id:"example-1in_process-mode",text:"Example 1\uFF1Ain_process mode",depth:4},{id:"example-2system-mode",text:"Example 2\uFF1Asystem mode",depth:4},{id:"perfetto-configuration-file",text:"Perfetto Configuration File",depth:4},{id:"exampleucp_in_processcfg",text:"Example\uFF1Aucp_in_process.cfg",depth:4},{id:"example",text:"Example",depth:3},{id:"in_process-mode",text:"in_process mode",depth:4},{id:"system-mode",text:"system mode",depth:4},{id:"bpu-trace",text:"BPU Trace",depth:3},{id:"chrome-trace",text:"Chrome Trace",depth:2},{id:"example-1",text:"Example",depth:3}],title:"UCP Trace Instructions",frontmatter:{}}},95895:function(e,s,n){n(39710);var r=n(85893),i=n(67294),l=n(45687);n(20388);let t={"zh-CN":e=>`\u{9884}\u{8BA1}\u{9605}\u{8BFB}\u{65F6}\u{95F4}: ${e.minutes>=1?`${Math.ceil(e.minutes)} \u{5206}\u{949F}`:"\u5C0F\u4E8E 1 \u5206\u949F"}`,"en-US":e=>`Estimated reading time: ${e.minutes>=1?`${Math.ceil(e.minutes)} minutes`:"less than 1 minute"}`};function c(e,s,n){let r=Object.keys(t).includes(s)?s:n;return t[r](e)}s.Z=e=>{let{defaultLocale:s="en-US"}=e,n=(0,l.Vi)().page.readingTimeData,t=(0,l.Jr)(),o=(0,l.e7)(),[a,h]=(0,i.useState)(c(n,t,s));return(0,i.useEffect)(()=>{h(c(n,t,s))},[t,n]),(0,r.jsx)("span",{"data-dark":String(o),className:"rp-reading-time",children:a})}}}]);