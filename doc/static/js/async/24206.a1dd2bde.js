"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["24206"],{97015:function(s,n,e){e.r(n);var l=e(85893),r=e(50065),o=e(95895);function i(s){let n=Object.assign({h1:"h1",a:"a",p:"p",code:"code",h2:"h2",h3:"h3",pre:"pre",span:"span",ul:"ul",li:"li"},(0,r.ah)(),s.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.h1,{id:"fx-quantization-\u539F\u7406\u4ECB\u7ECD",children:[(0,l.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#fx-quantization-\u539F\u7406\u4ECB\u7ECD",children:"#"}),"FX Quantization \u539F\u7406\u4ECB\u7ECD"]}),"\n",(0,l.jsx)(o.Z,{}),"\n",(0,l.jsxs)(n.p,{children:["\u9605\u8BFB\u6B64\u6587\u6863\u524D\uFF0C\u5EFA\u8BAE\u5148\u9605\u8BFB ",(0,l.jsx)(n.a,{href:"https://pytorch.org/docs/stable/fx.html",target:"_blank",rel:"noopener noreferrer",children:"torch.fx \u2014 PyTorch documentation"}),"\uFF0C\u4EE5\u5BF9 torch \u7684 FX \u673A\u5236\u6709\u521D\u6B65\u7684\u4E86\u89E3\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["FX \u91C7\u7528\u7B26\u53F7\u6267\u884C\u7684\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u5728 ",(0,l.jsx)(n.code,{children:"nn.Module"})," \u6216 function \u7684\u5C42\u9762\u5BF9\u6A21\u578B\u5EFA\u56FE\uFF0C\u4ECE\u800C\u5B9E\u73B0\u81EA\u52A8\u5316\u7684 fuse \u4EE5\u53CA\u5176\u4ED6\u57FA\u4E8E\u56FE\u7684\u4F18\u5316\u3002"]}),"\n",(0,l.jsxs)(n.h2,{id:"\u91CF\u5316\u6D41\u7A0B",children:[(0,l.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u91CF\u5316\u6D41\u7A0B",children:"#"}),"\u91CF\u5316\u6D41\u7A0B"]}),"\n",(0,l.jsxs)(n.h3,{id:"fuse\u53EF\u9009",children:[(0,l.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#fuse\u53EF\u9009",children:"#"}),"Fuse\uFF08\u53EF\u9009\uFF09"]}),"\n",(0,l.jsx)(n.p,{children:"FX \u53EF\u4EE5\u611F\u77E5\u8BA1\u7B97\u56FE\uFF0C\u6240\u4EE5\u53EF\u4EE5\u5B9E\u73B0\u81EA\u52A8\u5316\u7684\u7B97\u5B50\u878D\u5408\uFF0C\u60A8\u4E0D\u518D\u9700\u8981\u624B\u52A8\u6307\u5B9A\u9700\u8981\u878D\u5408\u7684\u7B97\u5B50\uFF0C\u76F4\u63A5\u8C03\u7528\u63A5\u53E3\u5373\u53EF\u3002"}),"\n",(0,l.jsx)(n.pre,{className:"code",children:(0,l.jsx)(n.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,l.jsxs)(n.code,{className:"language-python",meta:"",children:[(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"fused_model "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" horizon"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"quantization"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"fuse_fx"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(model)"})]}),"\n"]})})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u6CE8\u610F ",(0,l.jsx)(n.code,{children:"fuse_fx"})," \u6CA1\u6709 ",(0,l.jsx)(n.code,{children:"inplace"})," \u53C2\u6570\uFF0C\u56E0\u4E3A\u5185\u90E8\u9700\u8981\u5BF9\u6A21\u578B\u505A symbolic trace \u751F\u6210\u4E00\u4E2A ",(0,l.jsx)(n.code,{children:"GraphModule"}),"\uFF0C\u6240\u4EE5\u65E0\u6CD5\u505A\u5230 inplace \u7684\u4FEE\u6539\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"fused_model"})," \u548C ",(0,l.jsx)(n.code,{children:"model"})," \u4F1A\u5171\u4EAB\u51E0\u4E4E\u6240\u6709\u5C5E\u6027\uFF08\u5305\u62EC\u5B50\u6A21\u5757\u3001\u7B97\u5B50\u7B49\uFF09\uFF0C\u56E0\u6B64\u5728 fuse \u4E4B\u540E\u8BF7\u4E0D\u8981\u5BF9 ",(0,l.jsx)(n.code,{children:"model"})," \u505A\u4EFB\u4F55\u4FEE\u6539\uFF0C\u5426\u5219\u53EF\u80FD\u5F71\u54CD\u5230 ",(0,l.jsx)(n.code,{children:"fused_model"}),"\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4E0D\u5FC5\u663E\u5F0F\u8C03\u7528 ",(0,l.jsx)(n.code,{children:"fuse_fx"})," \u63A5\u53E3\uFF0C\u56E0\u4E3A\u540E\u7EED\u7684 ",(0,l.jsx)(n.code,{children:"prepare"})," \u63A5\u53E3\u5185\u90E8\u96C6\u6210\u4E86 fuse \u7684\u8FC7\u7A0B\u3002"]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"prepare",children:[(0,l.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#prepare",children:"#"}),"Prepare"]}),"\n",(0,l.jsxs)(n.p,{children:["\u5728\u8C03\u7528 ",(0,l.jsx)(n.code,{children:"prepare"})," \u63A5\u53E3\u4E4B\u524D\u5FC5\u987B\u6839\u636E\u76EE\u6807\u786C\u4EF6\u5E73\u53F0\u8BBE\u7F6E\u5168\u5C40\u7684 march\u3002\u63A5\u53E3\u5185\u90E8\u4F1A\u5148\u6267\u884C fuse \u8FC7\u7A0B\uFF08\u5373\u4F7F\u6A21\u578B\u5DF2\u7ECF fuse \u8FC7\u4E86\uFF09\uFF0C\u518D\u5C06\u6A21\u578B\u4E2D\u7B26\u5408\u6761\u4EF6\u7684\u7B97\u5B50\u66FF\u6362\u4E3A ",(0,l.jsx)(n.code,{children:"horizon.nn.qat"})," \u4E2D\u7684\u5B9E\u73B0\u3002"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u53EF\u4EE5\u6839\u636E\u9700\u8981\u9009\u62E9\u5408\u9002\u7684 qconfig\uFF08Calibtaion \u6216 QAT\uFF0C\u6CE8\u610F\u4E24\u79CD qconfig \u4E0D\u80FD\u6DF7\u7528\uFF09\u3002"}),"\n",(0,l.jsxs)(n.li,{children:["\u548C ",(0,l.jsx)(n.code,{children:"fuse_fx"})," \u7C7B\u4F3C\uFF0C\u6B64\u63A5\u53E3\u4E0D\u652F\u6301 ",(0,l.jsx)(n.code,{children:"inplace"})," \u53C2\u6570\uFF0C\u4E14\u5728 ",(0,l.jsx)(n.code,{children:"prepare"})," \u4E4B\u540E\u8BF7\u4E0D\u8981\u5BF9\u8F93\u5165\u7684\u6A21\u578B\u505A\u4EFB\u4F55\u4FEE\u6539\u3002"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{className:"code",children:(0,l.jsx)(n.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,l.jsxs)(n.code,{className:"language-python",meta:"",children:[(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"horizon"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"march"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"set_march"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(horizon.march.March.NASH)"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"qat_model "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" horizon"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"quantization"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"prepare"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    model,"})}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    qconfig_setter "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:" horizon.quantization.qconfig_template.default_qat_qconfig_setter,"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    method "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:" horizon.quantization.PrepareMethod.SYMBOLIC,"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n"]})})}),"\n",(0,l.jsxs)(n.h3,{id:"eager-mode-\u517C\u5BB9\u6027",children:[(0,l.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#eager-mode-\u517C\u5BB9\u6027",children:"#"}),"Eager Mode \u517C\u5BB9\u6027"]}),"\n",(0,l.jsxs)(n.p,{children:["\u5927\u90E8\u5206\u60C5\u51B5\u4E0B\uFF0CFX \u91CF\u5316\u7684\u63A5\u53E3\u53EF\u4EE5\u76F4\u63A5\u66FF\u6362 eager mode \u91CF\u5316\u7684\u63A5\u53E3\uFF08",(0,l.jsx)(n.code,{children:"prepare_qat"})," -> ",(0,l.jsx)(n.code,{children:"prepare"}),"\uFF09\uFF0C\u4F46\u662F\u4E0D\u80FD\u548C eager mode \u7684\u63A5\u53E3\u6DF7\u7528\u3002\u90E8\u5206\u6A21\u578B\u5728\u4EE5\u4E0B\u60C5\u51B5\u4E0B\u9700\u8981\u5BF9\u4EE3\u7801\u7ED3\u6784\u505A\u4E00\u5B9A\u7684\u4FEE\u6539\u3002"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"FX \u4E0D\u652F\u6301\u7684\u64CD\u4F5C\uFF1Atorch \u7684 symbolic trace \u652F\u6301\u7684\u64CD\u4F5C\u662F\u6709\u9650\u7684\uFF0C\u4F8B\u5982\u4E0D\u652F\u6301\u5C06\u975E\u9759\u6001\u53D8\u91CF\u4F5C\u4E3A\u5224\u65AD\u6761\u4EF6\u3001\u9ED8\u8BA4\u4E0D\u652F\u6301 torch \u4EE5\u5916\u7684 pkg\uFF08\u5982 numpy\uFF09\u7B49\uFF0C\u4E14\u672A\u6267\u884C\u5230\u7684\u6761\u4EF6\u5206\u652F\u5C06\u88AB\u4E22\u5F03\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u60F3\u88AB FX \u5904\u7406\u7684\u64CD\u4F5C\uFF1A\u5982\u679C\u6A21\u578B\u7684\u524D\u540E\u5904\u7406\u4E2D\u4F7F\u7528\u4E86 torch \u7684 op\uFF0CFX \u5728 trace \u65F6\u4F1A\u5C06\u4ED6\u4EEC\u89C6\u4E3A\u6A21\u578B\u7684\u4E00\u90E8\u5206\uFF0C\u4EA7\u751F\u4E0D\u7B26\u5408\u9884\u671F\u7684\u884C\u4E3A\uFF08\u4F8B\u5982\u5C06 torch \u7684\u67D0\u4E9B function \u8C03\u7528\u66FF\u6362\u4E3A FloatFunctional\uFF09\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u4EE5\u4E0A\u4E24\u79CD\u60C5\u51B5\uFF0C\u90FD\u53EF\u4EE5\u91C7\u7528 wrap \u7684\u65B9\u6CD5\u6765\u907F\u514D\uFF0C\u4E0B\u9762\u4EE5 RetinaNet \u4E3A\u4F8B\u8FDB\u884C\u8BF4\u660E\u3002"}),"\n",(0,l.jsx)(n.pre,{className:"code",children:(0,l.jsx)(n.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,l.jsxs)(n.code,{className:"language-python",meta:"",children:[(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" horizon_plugin_pytorch"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"fx"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"fx_helper "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" wrap "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"as"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" fx_wrap"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number"}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"RetinaNet"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"nn"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Module"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"__init__"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"backbone"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" nn"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"Module"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"neck"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"nn"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"Module"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"head"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"nn"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"Module"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"anchors"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"nn"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"Module"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"targets"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"nn"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"Module"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"post_process"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"nn"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"Module"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"loss_cls"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"nn"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"Module"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"loss_reg"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"nn"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"Module"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    ):"})}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"super"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(RetinaNet, self)."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"__init__"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number"}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"backbone "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" backbone"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"neck "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" neck"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"head "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" head"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"anchors "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" anchors"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"targets "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" targets"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"post_process "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" post_process"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"loss_cls "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" loss_cls"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"loss_reg "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" loss_reg"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number"}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"rearrange_head_out"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"inputs"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" List"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"torch"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"Tensor"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"],"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"num"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        outputs "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" []"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" t "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" inputs"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            outputs"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"append"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(t."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"permute"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:", "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:", "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:", "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:")."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"reshape"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(t.shape["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"], "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:", num))"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" torch"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"cat"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(outputs, dim"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number"}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"forward"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"data"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" Dict):"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        feat "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"backbone"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(data["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"img"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"])"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        feat "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"neck"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(feat)"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"neck "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" feat"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        cls_scores"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" bbox_preds "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"head"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(feat)"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number"}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"post_process "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"is"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" cls_scores"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" bbox_preds"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number"}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u5C06\u4E0D\u9700\u8981\u5EFA\u56FE\u7684\u64CD\u4F5C\u5C01\u88C5\u4E3A\u4E00\u4E2A method \u5373\u53EF\uFF0CFX \u5C06\u4E0D\u518D\u5173\u6CE8 method \u5185\u90E8\u7684\u903B\u8F91\uFF0C"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u4EC5\u5C06\u5B83\u539F\u6837\u4FDD\u7559\uFF08method \u4E2D\u8C03\u7528\u7684 module \u4ECD\u53EF\u88AB\u8BBE\u7F6E qconfig\uFF0C\u88AB prepare \u66FF\u6362\uFF09"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"_post_process"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"( data, feat, cls_scores, bbox_preds)"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number"}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"@fx_wrap"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# fx_wrap \u652F\u6301\u76F4\u63A5\u88C5\u9970 class method"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"_post_process"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"data"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"feat"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"cls_scores"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-parameter)"},children:"bbox_preds"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        anchors "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"anchors"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(feat)"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number"}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u5BF9 self.training \u7684\u5224\u65AD\u5FC5\u987B\u5C01\u88C5\u8D77\u6765\uFF0C\u5426\u5219\u5728 symbolic trace \u4E4B\u540E\uFF0C\u6B64\u5224\u65AD\u903B\u8F91\u4F1A\u88AB\u4E22\u6389"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"training"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            cls_scores "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"rearrange_head_out"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                cls_scores, self.head.num_classes"})}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            )"})}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            bbox_preds "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"rearrange_head_out"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(bbox_preds, "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"4"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            gt_labels "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"                torch"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"cat"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                    [data["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"gt_bboxes"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"][i], data["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"gt_classes"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"][i][:, "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"] "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"],"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                    dim"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=-"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                )"})}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"                "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" i "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"range"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"len"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(data["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"gt_classes"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]))"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            ]"})}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            gt_labels "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" [gt_label"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"float"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" gt_label "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" gt_labels]"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            _"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" labels "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"targets"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(anchors, gt_labels)"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            avg_factor "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" labels"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"reg_label_mask"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" avg_factor "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"                avg_factor "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"1"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            cls_loss "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"loss_cls"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                pred"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"cls_scores."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"sigmoid"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(),"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                target"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"labels["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"cls_label"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"],"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                weight"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"labels["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"cls_label_mask"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"],"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                avg_factor"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"avg_factor,"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            )"})}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            reg_loss "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"loss_reg"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                pred"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"bbox_preds,"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                target"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"labels["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"reg_label"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"],"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                weight"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"labels["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"reg_label_mask"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"],"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                avg_factor"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"avg_factor,"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            )"})}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"{"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"                "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"cls_loss"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" cls_loss"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"                "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"reg_loss"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" reg_loss"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"}"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            preds "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"post_process"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                anchors,"})}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                cls_scores,"})}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                bbox_preds,"})}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                [torch."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"tensor"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(shape) "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:" shape "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:" data["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"resized_shape"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]],"})]}),"\n",(0,l.jsx)(n.span,{className:"line line-number",children:(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            )"})}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"                "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"pred_bboxes"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"not"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" data"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"keys"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            )"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"pred_bboxes has been in data.keys()"'})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            data"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"pred_bboxes"'}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" preds"})]}),"\n",(0,l.jsxs)(n.span,{className:"line line-number",children:[(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" data"})]}),"\n"]})})})]})}function t(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.ah)(),s.components);return n?(0,l.jsx)(n,Object.assign({},s,{children:(0,l.jsx)(i,s)})):i(s)}n.default=t,t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["3.0.22%2Fzh%2Fguide%2Fplugin%2Fadvanced_tutorial%2Ffx_quantization_explain.mdx"]={toc:[{id:"\u91CF\u5316\u6D41\u7A0B",text:"\u91CF\u5316\u6D41\u7A0B",depth:2},{id:"fuse\u53EF\u9009",text:"Fuse\uFF08\u53EF\u9009\uFF09",depth:3},{id:"prepare",text:"Prepare",depth:3},{id:"eager-mode-\u517C\u5BB9\u6027",text:"Eager Mode \u517C\u5BB9\u6027",depth:3}],title:"FX Quantization \u539F\u7406\u4ECB\u7ECD",frontmatter:{}}},95895:function(s,n,e){e(39710);var l=e(85893),r=e(67294),o=e(45687);e(20388);let i={"zh-CN":s=>`\u{9884}\u{8BA1}\u{9605}\u{8BFB}\u{65F6}\u{95F4}: ${s.minutes>=1?`${Math.ceil(s.minutes)} \u{5206}\u{949F}`:"\u5C0F\u4E8E 1 \u5206\u949F"}`,"en-US":s=>`Estimated reading time: ${s.minutes>=1?`${Math.ceil(s.minutes)} minutes`:"less than 1 minute"}`};function t(s,n,e){let l=Object.keys(i).includes(n)?n:e;return i[l](s)}n.Z=s=>{let{defaultLocale:n="en-US"}=s,e=(0,o.Vi)().page.readingTimeData,i=(0,o.Jr)(),c=(0,o.e7)(),[a,h]=(0,r.useState)(t(e,i,n));return(0,r.useEffect)(()=>{h(t(e,i,n))},[i,e]),(0,l.jsx)("span",{"data-dark":String(c),className:"rp-reading-time",children:a})}}}]);