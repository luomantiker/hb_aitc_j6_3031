"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["83289"],{70815:function(n,s,e){n.exports=e.p+"static/image/qat.efed63ee.png"},99922:function(n,s,e){e.r(s);var i=e(85893),l=e(50065),r=e(95895),o=e(70815);function a(n){let s=Object.assign({h1:"h1",a:"a",p:"p",code:"code",ul:"ul",li:"li",h2:"h2",h3:"h3",pre:"pre",span:"span",ol:"ol",strong:"strong",h4:"h4",div:"div"},(0,l.ah)(),n.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.h1,{id:"\u5982\u4F55\u8FDB\u884C\u91CF\u5316\u8BAD\u7EC3",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5982\u4F55\u8FDB\u884C\u91CF\u5316\u8BAD\u7EC3",children:"#"}),"\u5982\u4F55\u8FDB\u884C\u91CF\u5316\u8BAD\u7EC3"]}),"\n",(0,i.jsx)(r.Z,{}),"\n",(0,i.jsxs)(s.p,{children:["\u672C\u6587\u6863\u4EC5\u8BF4\u660E\u5728HAT\u4E2D\u8FDB\u884C\u91CF\u5316\u8BAD\u7EC3\u65F6\u9700\u8981\u7684\u64CD\u4F5C\uFF0C\u5173\u4E8E\u91CF\u5316\u7684\u57FA\u672C\u539F\u7406\u548C\u5728\u8BAD\u7EC3\u6846\u67B6\u4E2D\u7684\u5B9E\u73B0\u65B9\u5F0F\u8BF7\u53C2\u9605 ",(0,i.jsx)(s.code,{children:"horizon_plugin_pytorch"})," \u7684\u76F8\u5173\u6587\u6863\u3002"]}),"\n",(0,i.jsx)(s.p,{children:"\u5728\u91CF\u5316\u8BAD\u7EC3\u4E2D\uFF0C\u7531\u6D6E\u70B9\u6A21\u578B\u5230\u5B9A\u70B9\u6A21\u578B\u7684\u8F6C\u6362\u6D41\u7A0B\u5982\u4E0B\uFF1A"}),"\n",(0,i.jsx)("img",{src:o,alt:"qat",width:"850"}),"\n",(0,i.jsxs)(s.p,{children:["\u5176\u4E2D\u5927\u90E8\u5206\u6B65\u9AA4\u90FD\u5DF2\u96C6\u6210\u5728HAT\u7684\u8BAD\u7EC3pipeline\u4E2D\uFF0C\u53EA\u9700\u6CE8\u610F\u5728\u6DFB\u52A0\u81EA\u5B9A\u4E49\u6A21\u578B\u65F6\u5B9E\u73B0 ",(0,i.jsx)(s.code,{children:"fuse_model"})," \u65B9\u6CD5\u6765\u5B8C\u6210\u6A21\u578B\u878D\u5408\uFF0C\u4E14\u5B9E\u73B0 ",(0,i.jsx)(s.code,{children:"set_qconfig"})," \u65B9\u6CD5\u5BF9\u91CF\u5316\u65B9\u5F0F\u8FDB\u884C\u914D\u7F6E\u5373\u53EF\u3002\u5728\u7F16\u5199\u6A21\u578B\u65F6\u9700\u8981\u6CE8\u610F\u4EE5\u4E0B\u51E0\u70B9\uFF1A"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["HAT\u53EA\u4F1A\u8C03\u7528\u6700\u5916\u5C42\u6A21\u5757\u7684 ",(0,i.jsx)(s.code,{children:"fuse_model"})," \u65B9\u6CD5\uFF0C\u56E0\u6B64\u5728 ",(0,i.jsx)(s.code,{children:"fuse_model"})," \u7684\u5B9E\u73B0\u4E2D\u8981\u8D1F\u8D23\u6240\u6709\u5B50\u6A21\u5757\u7684fuse\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["\u4F18\u5148\u4F7F\u7528 ",(0,i.jsx)(s.code,{children:"hat.models.base_modules"})," \u4E2D\u63D0\u4F9B\u7684\u57FA\u7840\u6A21\u5757\uFF0C\u8FD9\u4E9B\u57FA\u7840\u6A21\u5757\u5DF2\u5B9E\u73B0 ",(0,i.jsx)(s.code,{children:"fuse_model"})," \u65B9\u6CD5\uFF0C\u53EF\u51CF\u5C11\u5DE5\u4F5C\u91CF\u548C\u5F00\u53D1\u96BE\u5EA6\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["\u6A21\u578B\u6CE8\u518C\uFF0CHAT\u4E2D\u7684\u5404\u79CD\u6A21\u5757\u5168\u90E8\u91C7\u7528\u4E86\u6CE8\u518C\u673A\u5236\uFF0C\u53EA\u6709\u5C06\u5B9A\u4E49\u7684\u6A21\u578B\u5728\u5BF9\u5E94\u7684\u6CE8\u518C\u9879\u4E2D\u8FDB\u884C\u6CE8\u518C\uFF0C\u624D\u53EF\u4EE5\u5728config\u6587\u4EF6\u4E2D\u4EE5 ",(0,i.jsx)(s.code,{children:"dict(type={$class_name}, ...)"})," \u7684\u5F62\u5F0F\u4F7F\u7528\u6A21\u578B\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["\u9700\u8981\u5728\u6700\u5916\u5C42\u6A21\u5757\u5B9E\u73B0 ",(0,i.jsx)(s.code,{children:"set_qconfig"})," \u65B9\u6CD5\uFF0C\u5982\u679C\u5B50\u6A21\u5757\u4E2D\u6709\u7279\u6B8Alayer\u9700\u5355\u72EC\u8BBE\u7F6E QConfig\uFF0C\u4E5F\u9700\u8981\u5728\u8BE5\u5B50\u6A21\u5757\u4E2D\u5B9E\u73B0 ",(0,i.jsx)(s.code,{children:"set_qconfig"})," \u65B9\u6CD5\uFF0C\u6B64\u90E8\u5206\u7EC6\u8282\u53EF\u89C1 ",(0,i.jsx)(s.code,{children:"set_qconfig \u4E66\u5199\u89C4\u8303\u548C\u81EA\u5B9A\u4E49 qconfig \u4ECB\u7ECD"})," \u7AE0\u8282\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["\u6B64\u5916\uFF0C\u4E3A\u4F7F\u6A21\u578B\u53EF\u8F6C\u4E3A\u91CF\u5316\u6A21\u578B\uFF0C\u9700\u8981\u6EE1\u8DB3\u4E00\u4E9B\u6761\u4EF6\uFF0C\u5177\u4F53\u89C1",(0,i.jsx)(s.code,{children:"horizon_plugin_pytorch"})," \u7684\u76F8\u5173\u6587\u6863\u3002"]}),"\n",(0,i.jsxs)(s.h2,{id:"\u91CF\u5316\u8BAD\u7EC3\u6D41\u7A0B\u7B80\u4ECB",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u91CF\u5316\u8BAD\u7EC3\u6D41\u7A0B\u7B80\u4ECB",children:"#"}),"\u91CF\u5316\u8BAD\u7EC3\u6D41\u7A0B\u7B80\u4ECB"]}),"\n",(0,i.jsxs)(s.h3,{id:"\u6DFB\u52A0\u81EA\u5B9A\u4E49\u6A21\u578B",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u6DFB\u52A0\u81EA\u5B9A\u4E49\u6A21\u578B",children:"#"}),"\u6DFB\u52A0\u81EA\u5B9A\u4E49\u6A21\u578B"]}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-python",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" torch"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" torch "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" nn"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" hat"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"registry "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OBJECT_REGISTRY"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u4F7F\u7528\u88C5\u9970\u5668\u7684\u65B9\u5F0F\u5C06\u6A21\u578B\u8FDB\u884C\u6CE8\u518C"})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"@OBJECT_REGISTRY"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"register_module"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ExampleNet"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"nn"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Module"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"__init__"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        ..."})}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"forward"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"x"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        ..."})}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"fuse_model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u9700\u8981\u8C03\u7528\u6240\u6709\u5B50\u6A21\u5757\u7684 fuse_model \u65B9\u6CD5"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"hasattr"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(self.submodule, "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"fuse_model"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"):"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"submodule"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"fuse_model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u5177\u4F53 fuse \u7684\u63A5\u53E3\u89C1 horizon_plugin_pytorch \u6587\u6863"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        ..."})}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"set_qconfig"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u5177\u4F53\u6A21\u578B\u91CF\u5316\u914D\u7F6E\u7684\u63A5\u53E3\u89C1 horizon_plugin_pytorch \u6587\u6863"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" hat"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"utils "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" qconfig_manager"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u9ED8\u8BA4\u4F7F\u7528 qconfig_manager.get_default_qat_qconfig() \u5F97\u5230\u7684 QConfig"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"qconfig "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" qconfig_manager"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"get_default_qat_qconfig"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u5BF9\u9700\u8981\u7279\u6B8A\u5904\u7406\u7684\u5B50\u6A21\u5757\uFF0C\u8C03\u7528\u5B50\u6A21\u5757\u7684 set_qconfig\uFF0C"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u5B50\u6A21\u5757\u7684 set_qconfig  \u4E2D\u53EA\u9700\u5B9E\u73B0\u5BF9\u7279\u6B8A layer \u7684 QConfig \u8BBE\u7F6E"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"hasattr"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(self.submodule, "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"set_qconfig"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"):"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"submodule"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"set_qconfig"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u5982\u679C\u6709\u7279\u6B8A\u8282\u70B9\u4E0D\u9700\u8981\u8BBE\u7F6EQConfig\uFF0C\u6BD4\u5982 loss\uFF0C\u9700\u8981\u8BBE\u7F6E\u5176QConfig \u4E3A None"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"loss "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"is"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" Not "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"loss"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"qconfig "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"None"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        ..."})}),"\n"]})})}),"\n",(0,i.jsxs)(s.h3,{id:"\u6DFB\u52A0-config-\u6587\u4EF6",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u6DFB\u52A0-config-\u6587\u4EF6",children:"#"}),"\u6DFB\u52A0 config \u6587\u4EF6"]}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-python",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ckpt_dir "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ..."})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"model "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ExampleNet"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"float_trainer "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"distributed_data_parallel_trainer"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"model,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    data_loader"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    optimizer"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    batch_processor"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    num_epochs"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    device"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    callbacks"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ...,"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"qat_trainer "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"distributed_data_parallel_trainer"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"model,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    model_convert_pipeline"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ModelConvertPipeline"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        qat_mode"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"fuse_bn"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        converters"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"LoadCheckpoint"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                checkpoint_path"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"os.path."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"join"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                    ckpt_dir, "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"float-checkpoint-best.pth.tar"'})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                ),"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            ),"})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Float2QAT"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"),"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        ],"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ),"})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    data_loader"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    optimizer"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    batch_processor"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    num_epochs"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    device"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    callbacks"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ...,"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"val_callback "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Validation"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    data_loader"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    batch_processor"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    callbacks"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"[val_metric_updater, ...],"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"trace_callback "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SaveTraced"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    save_dir"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"ckpt_dir,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    trace_inputs"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"deploy_inputs,"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ckpt_callback "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Checkpoint"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    save_dir"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"ckpt_dir,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    name_prefix"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"training_step "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"-"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    strict_match"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"True"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    mode"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"max"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"int_trainer "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Trainer"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"deploy_model,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    model_convert_pipeline"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ModelConvertPipeline"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        qat_mode"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"fuse_bn"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        converters"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Float2QAT"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"),"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"LoadCheckpoint"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                checkpoint_path"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"os.path."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"join"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                    ckpt_dir, "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"qat-checkpoint-best.pth.tar"'})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                ),"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            ),"})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"QAT2Quantize"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"),"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        ],"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ),"})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# int_trainer \u4E2D\u5B9E\u9645\u4E0D\u5305\u542B\u8BAD\u7EC3\u6D41\u7A0B"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    data_loader"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    optimizer"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    batch_processor"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    num_epochs"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"################################"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    device"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    callbacks"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        ckpt_callback,"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        trace_callback,"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ],"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n"]})})}),"\n",(0,i.jsxs)(s.h2,{id:"\u8BAD\u7EC3",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u8BAD\u7EC3",children:"#"}),"\u8BAD\u7EC3"]}),"\n",(0,i.jsxs)(s.p,{children:["\u53EA\u9700\u5728\u4F7F\u7528 ",(0,i.jsx)(s.code,{children:"tools/train.py"})," \u811A\u672C\u65F6\u6309\u987A\u5E8F\u6307\u5B9A\u8BAD\u7EC3\u9636\u6BB5\u5373\u53EF\uFF0C\u4F1A\u81EA\u52A8\u6839\u636E\u8BAD\u7EC3\u9636\u6BB5\u8C03\u7528\u76F8\u5E94\u7684 ",(0,i.jsx)(s.code,{children:"solver"})," \u6765\u6267\u884C\u8BAD\u7EC3\u8FC7\u7A0B\uFF1A"]}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-python",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"python3 tools"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"train"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"py --stage "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"float"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ..."})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"python3 tools"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"train"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"py --stage qat ..."})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"python3 tools"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"/"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"train"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"py --stage int_infer ..."})]}),"\n"]})})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"float\uFF1A\u6B63\u5E38\u7684\u6D6E\u70B9\u8BAD\u7EC3\u3002"}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"qat\uFF1AQAT\u8BAD\u7EC3\uFF08\u91CF\u5316\u611F\u77E5\u8BAD\u7EC3\uFF09\uFF0C\u9996\u5148\u521D\u59CB\u5316\u4E00\u4E2A\u6D6E\u70B9\u6A21\u578B\uFF0C\u52A0\u8F7D\u8BAD\u7EC3\u597D\u7684\u6D6E\u70B9\u6A21\u578B\u6743\u91CD\uFF0C\u518D\u5C06\u6B64\u6A21\u70B9\u6A21\u578B\u8F6C\u4E3AQAT\u6A21\u578B\u8FDB\u884C\u8BAD\u7EC3\u3002"}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"int_infer\uFF1A\u5B9A\u70B9\u8F6C\u5316\u9884\u6D4B\uFF0C\u6B64\u9636\u6BB5\u9996\u5148\u521D\u59CB\u5316\u4E00\u6D6E\u70B9\u6A21\u578B\uFF0C\u5C06\u6B64\u6D6E\u70B9\u6A21\u578B\u5148\u8F6C\u4E3AQAT\u6A21\u578B\u5E76\u52A0\u8F7D\u8BAD\u7EC3\u597D\u7684QAT\u6A21\u578B\u6743\u91CD\uFF0C\u518D\u5C06 QAT\u6A21\u578B\u8F6C\u4E3A\u5B9A\u70B9\u6A21\u578B\u3002\u8F6C\u51FA\u7684\u5B9A\u70B9\u6A21\u578B\u65E0\u6CD5\u8FDB\u884C\u8BAD\u7EC3\uFF0C\u53EA\u80FD\u6267\u884Cvalidation\u5F97\u5230\u6700\u7EC8\u7684\u5B9A\u70B9\u6A21\u578B\u7CBE\u5EA6\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.h2,{id:"\u6062\u590D\u8BAD\u7EC3",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u6062\u590D\u8BAD\u7EC3",children:"#"}),"\u6062\u590D\u8BAD\u7EC3"]}),"\n",(0,i.jsxs)(s.p,{children:["\u53EF\u4EE5\u901A\u8FC7\u5728 ",(0,i.jsx)(s.code,{children:"config"})," \u7684 ",(0,i.jsx)(s.code,{children:"{stage}_trainer"})," \u4E2D\u914D\u7F6E ",(0,i.jsx)(s.code,{children:"resume_optimizer"})," \u548C ",(0,i.jsx)(s.code,{children:"resume_epoch_or_step"})," \u5B57\u6BB5\u6765\u6062\u590D\u610F\u5916\u4E2D\u65AD\u7684\u8BAD\u7EC3\uFF0C\u6216\u4EC5\u6062\u590Doptimizer\u6765\u8FDB\u884Cfine-tune\u3002\u4F8B\u5982\uFF1A"]}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-python",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"float_trainer "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ..."})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    model_convert_pipeline"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        ..."})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        converters"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"LoadCheckpoint"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                checkpoint_path"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"your_checkpoint_path"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:",  "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u8981 resume \u7684 checkpoint \u8DEF\u5F84"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            ),"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        ],"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ),"})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    resume_optimizer"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"True"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:",      "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u6062\u590D optimizer"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    resume_epoch_or_step"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"True"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:",  "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u6062\u590D epoch \u6216 step "})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ...,"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n"]})})}),"\n",(0,i.jsx)(s.p,{children:"\u6062\u590D\u8BAD\u7EC3\u6709\u4E09\u79CD\u4F7F\u7528\u573A\u666F\uFF1A"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"\u5B8C\u5168\u6062\u590D"}),"\uFF1A \u8BE5\u573A\u666F\u4E3A\u6062\u590D\u610F\u5916\u4E2D\u65AD\u7684\u8BAD\u7EC3\uFF0C\u4F1A\u6062\u590D\u4E0A\u4E00\u4E2Acheckpoint\u7684\u6240\u6709\u72B6\u6001\uFF0C\u5305\u62ECoptimizer\u3001LR\u3001epoch\u3001step \u7B49\u3002\u8BE5\u573A\u666F\u53EA\u9700\u914D\u7F6E ",(0,i.jsx)(s.code,{children:"resume_optimizer"})," \u5B57\u6BB5\u5373\u53EF\uFF1B"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"\u6062\u590Doptimizer\u7528\u4E8Efine-tune"}),"\uFF1A \u8BE5\u573A\u666F\u53EA\u4F1A\u6062\u590Doptimizer\u548CLR\u7684\u72B6\u6001\uFF0C\u4F46epoch\u3001step\u90FD\u4F1A\u4ECE0\u5F00\u59CB\uFF0C\u7528\u4E8E\u67D0\u4E9B\u4EFB\u52A1\u7684 fine-tune\u3002\u8BE5\u573A\u666F\u9700\u8981\u914D\u7F6E ",(0,i.jsx)(s.code,{children:"resume_optimizer"}),"\uFF0C\u5E76\u4E14\u9700\u8981\u914D\u7F6E",(0,i.jsx)(s.code,{children:"resume_epoch_or_step=False"}),"\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"\u53EA\u52A0\u8F7D\u6A21\u578B\u53C2\u6570"}),"\uFF1A \u8BE5\u573A\u666F\u53EA\u4F1A\u52A0\u8F7D\u6A21\u578B\u53C2\u6570\uFF0C\u4E0D\u4F1A\u6062\u590D\u5176\u4ED6\u4EFB\u4F55\u72B6\u6001(optimizer\u3001epoch\u3001step\u3001LR)\u3002\u8BE5\u573A\u666F\u53EA\u9700\u8981\u5728 ",(0,i.jsx)(s.code,{children:"model_convert_pipeline"})," \u4E2D\u914D\u7F6E ",(0,i.jsx)(s.code,{children:"LoadCheckpoint"})," \uFF0C\u5E76\u4E14\u9700\u8981\u914D\u7F6E ",(0,i.jsx)(s.code,{children:"resume_optimizer=False"})," \u548C ",(0,i.jsx)(s.code,{children:"resume_epoch_or_step=False"}),"\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.h2,{id:"qat_mode",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#qat_mode",children:"#"}),"qat_mode"]}),"\n",(0,i.jsxs)(s.h3,{id:"\u4F5C\u7528",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u4F5C\u7528",children:"#"}),"\u4F5C\u7528"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"qat_mode"})," \u7528\u4E8E\u8BBE\u7F6EQAT\u9636\u6BB5\u662F\u5426\u5E26BN\u8FDB\u884C\u91CF\u5316\u8BAD\u7EC3\uFF0C\u914D\u5408HAT\u63D0\u4F9B\u7684 ",(0,i.jsx)(s.code,{children:"FuseBN"})," \u63A5\u53E3\u8FD8\u53EF\u4EE5\u63A7\u5236\u91CF\u5316\u8BAD\u7EC3\u5168\u7A0B\u5E26BN\u6216\u662F\u4E2D\u9014\u9010\u6B65\u5438\u6536BN\u3002"]}),"\n",(0,i.jsxs)(s.h3,{id:"\u53EF\u9009\u9879\u5B9A\u4E49",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u53EF\u9009\u9879\u5B9A\u4E49",children:"#"}),"\u53EF\u9009\u9879\u5B9A\u4E49"]}),"\n",(0,i.jsx)(s.p,{children:"qat_mode\u53EF\u9009\u7684\u8BBE\u7F6E\u6709\u5982\u4E0B\u4E09\u79CD\uFF1A"}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-python",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"QATMode"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"object"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    FuseBN "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"fuse_bn"'})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    WithBN "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"with_bn"'})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    WithBNReverseFold "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"with_bn_reverse_fold"'})]}),"\n"]})})}),"\n",(0,i.jsxs)(s.h3,{id:"\u539F\u7406\u4ECB\u7ECD",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u539F\u7406\u4ECB\u7ECD",children:"#"}),"\u539F\u7406\u4ECB\u7ECD"]}),"\n",(0,i.jsxs)(s.h4,{id:"fuse_bn",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#fuse_bn",children:"#"}),"fuse_bn"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"QAT\u9636\u6BB5\u6CA1\u6709BN\uFF0CHAT\u9ED8\u8BA4\u7684\u91CF\u5316\u8BAD\u7EC3\u65B9\u5F0F\u3002"})}),"\n",(0,i.jsxs)(s.p,{children:["\u901A\u8FC7\u5C06qat_mode\u8BBE\u7F6E\u4E3A ",(0,i.jsx)(s.code,{children:"fuse_bn"})," \uFF0C\u5728\u6D6E\u70B9\u6A21\u578Bop\u878D\u5408\u7684\u8FC7\u7A0B\u4E2D\uFF0CBN\u7684weight\u548Cbias\u5747\u88AB\u5438\u6536\u5230Conv\u7684weight\u548Cbias\u4E2D\uFF0C\u539F\u6765\u7684Conv + BN\u7684\u7EC4\u5408\u5C06\u53EA\u5269\u4E0B Conv\uFF0C\u8FD9\u4E00\u5438\u6536\u8FC7\u7A0B\u7406\u8BBA\u4E0A\u662F\u6CA1\u6709\u8BEF\u5DEE\u7684\u3002"]}),"\n",(0,i.jsxs)(s.h4,{id:"with_bn",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#with_bn",children:"#"}),"with_bn"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"QAT \u9636\u6BB5\u5E26 BN \u8FDB\u884C\u8BAD\u7EC3\u3002"})}),"\n",(0,i.jsxs)(s.p,{children:["\u901A\u8FC7\u8BBE\u7F6Eqat_mode\u4E3A ",(0,i.jsx)(s.code,{children:"with_bn"})," \uFF0C\u6D6E\u70B9\u6A21\u578B\u8F6C\u4E3AQAT\u6A21\u578B\u7684\u65F6\u5019BN\u4E0D\u4F1A\u5438\u6536\u8FDBConv\uFF0C\u800C\u662F\u5728QAT\u9636\u6BB5\u4EE5 ",(0,i.jsx)(s.code,{children:"Conv + BN + \u8F93\u51FA\u91CF\u5316\u8282\u70B9"})," \u7684\u5F62\u5F0F\u4F5C\u4E3A\u4E00\u4E2A\u88AB\u878D\u5408\u7684\u91CF\u5316op\u5B58\u5728\u4E8E\u91CF\u5316\u6A21\u578B\u4E2D\u3002\u6700\u7EC8\u5728\u91CF\u5316\u8BAD\u7EC3\u7ED3\u675F\u8F6C\u4E3Aquantized(\u4E5F\u79F0int infer) \u6A21\u578B\u7684\u6B65\u9AA4\u4E2D\uFF0CBN\u7684weight\u548Cbias\u5C06\u81EA\u52A8\u5438\u6536\u8FDBconv\u7684\u91CF\u5316\u53C2\u6570\u4E2D\uFF0C\u5438\u6536\u4E4B\u540E\u5F97\u5230\u7684quantized op\u548C\u539F\u6765\u7684QAT op\u8BA1\u7B97\u7ED3\u679C\u4FDD\u6301\u4E00\u81F4\u3002"]}),"\n",(0,i.jsx)(s.p,{children:"\u5728\u8FD9\u4E00\u6A21\u5F0F\u4E0B\uFF0C\u60A8\u8FD8\u53EF\u4EE5\u9009\u62E9\u5728QAT\u4E2D\u9014\u5C06BN\u5438\u6536\u8FDBConv\u3002\u624B\u52A8\u5438\u6536BN\u524D\u540EQAT\u6A21\u578B\u7684forward\u7ED3\u679C\u4E0D\u4E00\u81F4\uFF0C\u539F\u56E0\u662FBN weight\u5438\u6536\u81F3Conv weight\u4E4B\u540E\uFF0C\u5728\u4E4B\u524D\u91CF\u5316\u8BAD\u7EC3\u4E2D\u7EDF\u8BA1\u51FA\u6765\u7684\u91CF\u5316\u53C2\u6570conv_weight_scale\u4E0D\u518D\u9002\u7528\u4E8E\u5F53\u524D\u7684conv_weight\uFF0C\u5728\u5BF9conv_weight\u7684\u91CF\u5316\u4E2D\u5C06\u4EA7\u751F\u8F83\u5927\u8BEF\u5DEE\uFF0C\u9700\u8981\u7EE7\u7EED\u8FDB\u884C\u91CF\u5316\u8BAD\u7EC3\u8C03\u6574\u91CF\u5316\u53C2\u6570\u3002"}),"\n",(0,i.jsxs)(s.h4,{id:"with_bn_reverse_fold",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#with_bn_reverse_fold",children:"#"}),"with_bn_reverse_fold"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"QAT \u9636\u6BB5\u5E26 BN \u8FDB\u884C\u8BAD\u7EC3\u3002"})}),"\n",(0,i.jsxs)(s.p,{children:["\u672C\u6A21\u5F0F\u4E0E ",(0,i.jsx)(s.code,{children:"with_bn"})," \u7684\u4E0D\u540C\u4E4B\u5904\u5728\u4E8E\u5728BN\u5438\u6536\u4E4B\u524D\uFF0C\u91CF\u5316\u8BAD\u7EC3\u9636\u6BB5\u8BA1\u7B97conv_weight_scale\u65F6\u4F1A\u8003\u8651BN\u7684weight(\u5177\u4F53\u7684\u8BA1\u7B97\u65B9\u5F0F\u4E0D\u5728\u6B64\u8BE6\u8FF0)\uFF0C\u76EE\u7684\u662F\u4E3A\u4E86\u5438\u6536BN weight\u4E4B\u540Econv_weight_scale\u4ECD\u7136\u9002\u7528\u4E8E\u65B0\u7684conv_weight\u3002"]}),"\n",(0,i.jsx)(s.p,{children:"\u8BE5\u6A21\u5F0F\u7528\u610F\u662F\u4E3A\u5206\u6B65\u5438\u6536BN\u63D0\u4F9B\u4E00\u79CD\u65E0\u635F\u7684\u5438\u6536\u65B9\u5F0F\uFF1A\u5728\u91CF\u5316\u8BAD\u7EC3\u4E2D\u9014\u5438\u6536BN\uFF0C\u5438\u6536\u524D\u540E\u6A21\u578Bforward\u7ED3\u679C\u7406\u8BBA\u4E0A\u5B8C\u5168\u4E00\u81F4\uFF0C\u60A8\u53EF\u4EE5\u5728\u91CF\u5316\u8BAD\u7EC3\u7ED3\u675F\u524D\u9010\u6B65\u5438\u6536\u6A21\u578B\u4E2D\u6240\u6709\u7684BN\u5E76\u4E14\u4FDD\u8BC1\u6BCF\u6B21\u5438\u6536\u4E4B\u540Eloss\u4E0D\u4F1A\u6709\u592A\u5927\u7684\u6CE2\u52A8\u3002"}),"\n",(0,i.jsx)(s.p,{children:"\u5728\u8BE5\u6A21\u5F0F\u4E0B\u5982\u679C\u6709BN\u5728\u91CF\u5316\u8BAD\u7EC3\u7ED3\u675F\u65F6\u4ECD\u672A\u88AB\u5438\u6536\uFF0C\u5728QAT\u6A21\u578B\u8F6Cquantized\u6A21\u578B\u7684\u8FC7\u7A0B\u4E2D\u5269\u4F59\u7684BN\u5C06\u81EA\u52A8\u88AB\u5438\u6536\uFF0C\u8FD9\u4E00\u5438\u6536\u64CD\u4F5C\u7406\u8BBA\u4E0A\u662F\u65E0\u635F\u7684\u3002"}),"\n",(0,i.jsxs)(s.h3,{id:"\u7528\u6CD5",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u7528\u6CD5",children:"#"}),"\u7528\u6CD5"]}),"\n",(0,i.jsxs)(s.h4,{id:"\u8BBE\u7F6E-qat_mode",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u8BBE\u7F6E-qat_mode",children:"#"}),"\u8BBE\u7F6E qat_mode"]}),"\n",(0,i.jsxs)(s.p,{children:["\u53EA\u9700\u8981\u5728 ",(0,i.jsx)(s.code,{children:"model_convert_pipeline"})," \u4E2D\u8BBE\u7F6E ",(0,i.jsx)(s.code,{children:"qat_mode"})," \u5373\u53EF\u3002"]}),"\n",(0,i.jsx)(s.p,{children:"\u4F8B\u5982\uFF1A"}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-python",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"model_convert_pipeline"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ModelConvertPipeline"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    qat_mode"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"with_bn"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    converters"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Float2QAT"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"),"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"LoadCheckpoint"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            checkpoint_path"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"os.path."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"join"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                ckpt_dir, "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"qat-checkpoint-best.pth.tar"'})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            ),"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        ),"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ],"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n"]})})}),"\n",(0,i.jsxs)(s.h4,{id:"\u67E5\u770B\u5F53\u524D-qat_mode",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u67E5\u770B\u5F53\u524D-qat_mode",children:"#"}),"\u67E5\u770B\u5F53\u524D qat_mode"]}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-python",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" horizon_plugin_pytorch"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"qat_mode "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" get_qat_mode"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"qat_mod "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"get_qat_mode"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n"]})})}),"\n",(0,i.jsxs)(s.h4,{id:"\u8BBE\u7F6E\u9010\u6B65\u5438\u6536-bn",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#\u8BBE\u7F6E\u9010\u6B65\u5438\u6536-bn",children:"#"}),"\u8BBE\u7F6E\u9010\u6B65\u5438\u6536 BN"]}),"\n",(0,i.jsxs)(s.p,{children:["\u5728 ",(0,i.jsx)(s.code,{children:"with_bn"})," \u548C ",(0,i.jsx)(s.code,{children:"with_bn_reverse_fold"})," \u4E24\u79CD\u6A21\u5F0F\u4E0B\uFF0C\u53EF\u4EE5\u5C06 ",(0,i.jsx)(s.code,{children:"FuseBN"})," \u8BBE\u7F6E\u4E3A\u56DE\u8C03\u51FD\u6570\u7528\u4E8E\u5728\u6307\u5B9A\u7684epoch\u6216\u662Fstep\u5438\u6536\u6307\u5B9Amodule\u4E2D\u7684BN\u3002"]}),"\n",(0,i.jsx)(s.p,{children:"FuseBN\u5B9A\u4E49\uFF1A"}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-python",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"FuseBN"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"OnlineModelTrick"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    Args"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        module"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" sub model names to fuse BN"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        step_or_epoch"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" when to fuseBN"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" same length "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"as"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" module"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        update_by"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" by step "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"or"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" by epoch"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        inplace"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" fuse BN inplace"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"__init__"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"self"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"modules"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" List"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"List"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"str"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]],"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"step_or_epoch"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" List"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"],"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"update_by"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"str"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"inplace"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"bool"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"False"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    )"})}),"\n"]})})}),"\n",(0,i.jsx)(s.p,{children:"\u5728config\u6587\u4EF6\u4E2D\u4F7F\u7528FuseBN Example\uFF1A"}),"\n",(0,i.jsx)(s.pre,{className:"code",children:(0,i.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,i.jsxs)(s.code,{className:"language-python",meta:"",children:[(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" hat"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"callbacks "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" FuseBN"})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u5B9A\u4E49\u56DE\u8C03\u51FD\u6570"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u547D\u540D\u4E3A backbone \u7684 module \u4E2D\u7684 BN \u5C06\u5728\u7B2C 1000 \u4E2A step \u88AB\u5438\u6536"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u547D\u540D\u4E3A neck \u7684 module \u4E2D\u7684 BN \u5C06\u5728\u7B2C 1500 \u4E2A step \u88AB\u5438\u6536"})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"fuse_bn_callback "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"FuseBN"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"   modules"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"[["}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'backbone'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"], ["}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'neck'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]],"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"   step_or_epoch"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1000"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:", "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1500"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"],"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"   update_by"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'step'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number"}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# \u5C06\u56DE\u8C03\u51FD\u6570\u52A0\u5165\u5230 trainer \u4E2D"})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"qat_trainer "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"distributed_data_parallel_trainer"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    model"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"model,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    model_convert_pipeline"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ModelConvertPipeline"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        qat_mode"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"fuse_bn"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        converters"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Float2QAT"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"),"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"dict"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"LoadCheckpoint"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                checkpoint_path"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"os.path."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"join"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                    ckpt_dir, "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"qat-checkpoint-best.pth.tar"'})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"                ),"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"            ),"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        ],"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ),"})}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    data_loader"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    optimizer"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    batch_processor"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    num_epochs"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"...,"})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    device"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{className:"line line-number",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    callbacks"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["})]}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        callbacks0,"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        ..., "})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        fuse_bn_callback,"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        callbacks99"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ],"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    ...,"})}),"\n",(0,i.jsx)(s.span,{className:"line line-number",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})}),"\n"]})})}),"\n",(0,i.jsxs)(s.h3,{id:"qat_mode-\u603B\u7ED3",children:[(0,i.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#qat_mode-\u603B\u7ED3",children:"#"}),"qat_mode \u603B\u7ED3"]}),"\n",(0,i.jsxs)("table",{children:[(0,i.jsxs)("colgroup",{children:[(0,i.jsx)("col",{style:{width:"15%"}}),(0,i.jsx)("col",{style:{width:"28%"}}),(0,i.jsx)("col",{style:{width:"32%"}}),(0,i.jsx)("col",{style:{width:"25%"}})]}),(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"qat_mode "})}),(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"BN \u4F55\u65F6\u88AB\u5438\u6536"})}),(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"\u5982\u4F55\u5438\u6536BN  "})}),(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"\u7406\u8BBA\u4E0A\u5438\u6536\u540E\u6A21\u578B forward \u7ED3\u679C\u662F\u5426\u6709\u53D8\u5316"})})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"fuse_bn"}),(0,i.jsx)("td",{children:"\u4E00\u5B9A\u5728\u6D6E\u70B9\u6A21\u578B op \u878D\u5408\u8FC7\u7A0B"}),(0,i.jsx)("td",{children:"\u6267\u884C fuse_module \u4E4B\u540E\u5438\u6536\u5B8C\u6210"}),(0,i.jsx)("td",{children:"\u65E0"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"with_bn"}),(0,i.jsx)("td",{children:"\u53EF\u4EE5\u5728\u91CF\u5316\u8BAD\u7EC3\u4E2D\u9014 "}),(0,i.jsx)("td",{children:"\u901A\u8FC7\u8BBE\u7F6E\u56DE\u8C03\u51FD\u6570\u5728\u6307\u5B9A epoch \u6216 batch \u5438\u6536"}),(0,i.jsx)("td",{children:"\u6709"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"with_bn"}),(0,i.jsx)("td",{children:"\u53EF\u4EE5\u5728 QAT \u6A21\u578B\u8F6C quantized \u6A21\u578B\u8FC7\u7A0B"}),(0,i.jsx)("td",{children:"\u968F QAT \u8F6C quantized \u81EA\u52A8\u5B8C\u6210"}),(0,i.jsx)("td",{children:"\u65E0"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"with_bn_reverse_fold"}),(0,i.jsx)("td",{children:"\u53EF\u4EE5\u5728\u91CF\u5316\u8BAD\u7EC3\u4E2D\u9014"}),(0,i.jsx)("td",{children:"\u901A\u8FC7\u8BBE\u7F6E\u56DE\u8C03\u51FD\u6570\u5728\u6307\u5B9A epoch \u6216 batch \u5438\u6536"}),(0,i.jsx)("td",{children:"\u65E0"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"with_bn_reverse_fold"}),(0,i.jsx)("td",{children:"\u53EF\u4EE5\u5728 QAT \u6A21\u578B\u8F6C quantized \u6A21\u578B\u8FC7\u7A0B"}),(0,i.jsx)("td",{children:"\u968F QAT \u8F6C quantized \u81EA\u52A8\u5B8C\u6210"}),(0,i.jsx)("td",{children:"\u65E0"})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:["\u4E00\u822C\u8BAD\u7EC3\u6D41\u7A0B\u662F\u6D6E\u70B9\u8BAD\u7EC3\u5230\u7406\u60F3\u7CBE\u5EA6\u7136\u540E\u91CF\u5316\u8BAD\u7EC3\uFF0C\u8BE5\u6D41\u7A0B\u53EA\u9700\u8981\u4F7F\u7528 ",(0,i.jsx)(s.code,{children:"fuse_bn"})," \u5373\u53EF\u3002\u5982\u679C\u662F\u6CA1\u6709\u6D6E\u70B9\u8BAD\u7EC3\u4E00\u5F00\u59CB\u5C31\u662F\u91CF\u5316\u8BAD\u7EC3\uFF0C\u4E3A\u4E86\u786E\u4FDD\u6A21\u578B\u80FD\u6536\u655B\uFF0C\u624D\u9700\u8981\u4F7F\u7528\u5E26BN\u7684\u91CF\u5316\u8BAD\u7EC3\u6A21\u5F0F\u3002"]}),"\n",(0,i.jsxs)(s.div,{className:"rspress-directive info",children:[(0,i.jsx)(s.div,{className:"rspress-directive-title",children:"\u6CE8\u89E3"}),(0,i.jsx)(s.div,{className:"rspress-directive-content",children:(0,i.jsx)(s.p,{children:"\u672C\u6587\u4E2D\u4E4B\u6240\u4EE5\u8BF4\u201C\u7406\u8BBA\u4E0A\u5438\u6536\u524D\u540E\u65E0\u635F\u201D\u6216\u201C\u65E0\u53D8\u5316\u201D\uFF0C\u662F\u7531\u4E8E\u5728\u5B9E\u9645\u8BA1\u7B97\u4E2D\u5438\u6536\u524D\u540E\u4E24\u6B21\u6D6E\u70B9\u8BA1\u7B97\u7684\u7ED3\u679C\u6709\u8F83\u4F4E\u7684\u6982\u7387\u4F1A\u5728\u5C0F\u6570\u70B9\u8F83\u9760\u540E\u7684\u6570\u4F4D\u4E0A\u4E0D\u4E00\u81F4\uFF0C\u5FAE\u5C0F\u7684\u53D8\u5316\u52A0\u4E0A\u91CF\u5316\u64CD\u4F5C\u5BFC\u81F4\u5438\u6536BN\u540EConv\u7684\u8F93\u51FA\u76F8\u6BD4\u5438\u6536\u524DConv + BN\u7684\u8F93\u51FA\u5728\u90E8\u5206\u6570\u503C\u4E0A\u53EF\u80FD\u4F1A\u4EA7\u751F\u4E00\u4E2A\u8F93\u51FAscale\u7684\u7EDD\u5BF9\u8BEF\u5DEE\u3002"})})]})]})}function c(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,l.ah)(),n.components);return s?(0,i.jsx)(s,Object.assign({},n,{children:(0,i.jsx)(a,n)})):a(n)}s.default=c,c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["3.0.22%2Fzh%2Fguide%2Fadvanced_content%2Fhat%2Ftutorials%2Fquantization.mdx"]={toc:[{id:"\u91CF\u5316\u8BAD\u7EC3\u6D41\u7A0B\u7B80\u4ECB",text:"\u91CF\u5316\u8BAD\u7EC3\u6D41\u7A0B\u7B80\u4ECB",depth:2},{id:"\u6DFB\u52A0\u81EA\u5B9A\u4E49\u6A21\u578B",text:"\u6DFB\u52A0\u81EA\u5B9A\u4E49\u6A21\u578B",depth:3},{id:"\u6DFB\u52A0-config-\u6587\u4EF6",text:"\u6DFB\u52A0 config \u6587\u4EF6",depth:3},{id:"\u8BAD\u7EC3",text:"\u8BAD\u7EC3",depth:2},{id:"\u6062\u590D\u8BAD\u7EC3",text:"\u6062\u590D\u8BAD\u7EC3",depth:2},{id:"qat_mode",text:"qat_mode",depth:2},{id:"\u4F5C\u7528",text:"\u4F5C\u7528",depth:3},{id:"\u53EF\u9009\u9879\u5B9A\u4E49",text:"\u53EF\u9009\u9879\u5B9A\u4E49",depth:3},{id:"\u539F\u7406\u4ECB\u7ECD",text:"\u539F\u7406\u4ECB\u7ECD",depth:3},{id:"fuse_bn",text:"fuse_bn",depth:4},{id:"with_bn",text:"with_bn",depth:4},{id:"with_bn_reverse_fold",text:"with_bn_reverse_fold",depth:4},{id:"\u7528\u6CD5",text:"\u7528\u6CD5",depth:3},{id:"\u8BBE\u7F6E-qat_mode",text:"\u8BBE\u7F6E qat_mode",depth:4},{id:"\u67E5\u770B\u5F53\u524D-qat_mode",text:"\u67E5\u770B\u5F53\u524D qat_mode",depth:4},{id:"\u8BBE\u7F6E\u9010\u6B65\u5438\u6536-bn",text:"\u8BBE\u7F6E\u9010\u6B65\u5438\u6536 BN",depth:4},{id:"qat_mode-\u603B\u7ED3",text:"qat_mode \u603B\u7ED3",depth:3}],title:"\u5982\u4F55\u8FDB\u884C\u91CF\u5316\u8BAD\u7EC3",frontmatter:{}}},95895:function(n,s,e){e(39710);var i=e(85893),l=e(67294),r=e(45687);e(20388);let o={"zh-CN":n=>`\u{9884}\u{8BA1}\u{9605}\u{8BFB}\u{65F6}\u{95F4}: ${n.minutes>=1?`${Math.ceil(n.minutes)} \u{5206}\u{949F}`:"\u5C0F\u4E8E 1 \u5206\u949F"}`,"en-US":n=>`Estimated reading time: ${n.minutes>=1?`${Math.ceil(n.minutes)} minutes`:"less than 1 minute"}`};function a(n,s,e){let i=Object.keys(o).includes(s)?s:e;return o[i](n)}s.Z=n=>{let{defaultLocale:s="en-US"}=n,e=(0,r.Vi)().page.readingTimeData,o=(0,r.Jr)(),c=(0,r.e7)(),[t,h]=(0,l.useState)(a(e,o,s));return(0,l.useEffect)(()=>{h(a(e,o,s))},[o,e]),(0,i.jsx)("span",{"data-dark":String(c),className:"rp-reading-time",children:t})}}}]);